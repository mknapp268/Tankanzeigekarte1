<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Oil Tank Level Viewer</title>
    
    <style>
      /* --- Base & Fonts --- */
      body {
        background-color: #0f172a; /* bg-slate-900 */
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        color: #fff; /* text-white */
      }
      .font-sans { font-family: sans-serif; }
      .font-bold { font-weight: 700; }
      .font-semibold { font-weight: 600; }
      .font-medium { font-weight: 500; }
      .font-mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
      .tracking-wider { letter-spacing: 0.05em; }

      /* --- Layout & Sizing --- */
      .min-h-screen { min-height: 100vh; }
      .w-full { width: 100%; }
      .w-80 { width: 20rem; }
      .h-4 { height: 1rem; }
      .h-64 { height: 16rem; }
      .h-full { height: 100%; }
      .max-w-4xl { max-width: 80rem; }
      .mx-auto { margin-left: auto; margin-right: auto; }
      .p-4 { padding: 1rem; }
      .p-6 { padding: 1.5rem; }
      .pt-6 { padding-top: 1.5rem; }
      .px-1 { padding-left: 0.25rem; padding-right: 0.25rem; }
      .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
      .mt-2 { margin-top: 0.5rem; }
      .mt-6 { margin-top: 1.5rem; }
      .mt-8 { margin-top: 2rem; }
      .mb-2 { margin-bottom: 0.5rem; }
      .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; }
      
      /* --- Flex & Grid --- */
      .flex { display: flex; }
      .flex-col { flex-direction: column; }
      .items-center { align-items: center; }
      .justify-center { justify-content: center; }
      .justify-start { justify-content: flex-start; }
      .gap-1 { gap: 0.25rem; }
      .gap-3 { gap: 0.75rem; }
      .gap-4 { gap: 1rem; }
      .gap-8 { gap: 2rem; }
      .grid { display: grid; }
      .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }

      /* --- Borders & Shadows --- */
      .border { border-width: 1px; }
      .border-4 { border-width: 4px; }
      .border-b { border-bottom-width: 1px; }
      .border-t { border-top-width: 1px; }
      .border-slate-600 { border-color: #475569; }
      .border-slate-700 { border-color: #334155; }
      .border-red-700 { border-color: #b91c1c; }
      .rounded-lg { border-radius: 0.5rem; }
      .rounded-md { border-radius: 0.375rem; }
      .rounded-2xl { border-radius: 1rem; }
      .rounded-full { border-radius: 9999px; }
      .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
      .shadow-inner { box-shadow: inset 0 2px 4px 0 rgba(0,0,0,0.05); }

      /* --- Colors & Backgrounds --- */
      .bg-slate-700 { background-color: #334155; }
      .bg-slate-700\/50 { background-color: rgba(51, 65, 85, 0.5); }
      .bg-slate-700\/70 { background-color: rgba(51, 65, 85, 0.7); }
      .bg-slate-800\/50 { background-color: rgba(30, 41, 59, 0.5); }
      .bg-slate-900 { background-color: #0f172a; }
      .bg-slate-900\/50 { background-color: rgba(15, 23, 42, 0.5); }
      .bg-amber-300 { background-color: #fcd34d; }
      .bg-amber-500 { background-color: #f59e0b; }
      .bg-red-900\/50 { background-color: rgba(127, 29, 29, 0.5); }
      .text-amber-300 { color: #fcd34d; }
      .text-red-300 { color: #fca5a5; }
      .text-slate-300 { color: #cbd5e1; }
      .text-slate-400 { color: #94a3b8; }
      .text-slate-500 { color: #64748b; }
      
      /* --- Text & Sizing --- */
      .text-center { text-align: center; }
      .text-left { text-align: left; }
      .text-xs { font-size: 0.75rem; }
      .text-sm { font-size: 0.875rem; }
      .text-lg { font-size: 1.125rem; }
      .text-2xl { font-size: 1.5rem; }
      .whitespace-nowrap { white-space: nowrap; }

      /* --- Transitions & Animations --- */
      .transition-all { transition-property: all; }
      .duration-700 { transition-duration: 700ms; }
      .ease-out { transition-timing-function: cubic-bezier(0, 0, 0.2, 1); }
      @keyframes wave {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }
      .animate-wave { animation: wave linear infinite; }

      /* --- Other --- */
      .overflow-hidden { overflow: hidden; }
      .relative { position: relative; }
      .absolute { position: absolute; }
      .left-0 { left: 0; }
      .top-0 { top: 0; }
      .backdrop-blur-sm { backdrop-filter: blur(4px); }
      .appearance-none { appearance: none; }
      .cursor-pointer { cursor: pointer; }
      
      /* --- Component Specific --- */
      .main-card { width: 100%; max-width: 80rem; margin-left: auto; margin-right: auto; background-color: rgba(30, 41, 59, 0.5); border-radius: 1rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); backdrop-filter: blur(4px); border: 1px solid #334155; }
      .info-display { padding: 1rem; border-radius: 0.5rem; background-color: rgba(51, 65, 85, 0.7); }
      .warning-box { padding: 1rem; border-radius: 0.5rem; background-color: rgba(127, 29, 29, 0.5); border: 1px solid #b91c1c; color: #fca5a5; display: flex; align-items: center; gap: 0.75rem; }
      .slider { width: 100%; height: 0.5rem; background-color: #334155; border-radius: 0.5rem; appearance: none; cursor: pointer; }

      /* --- Responsive --- */
      @media (min-width: 768px) { /* md: */
        .md\:text-3xl { font-size: 1.875rem; }
        .md\:w-96 { width: 24rem; }
        .md\:h-72 { height: 18rem; }
        .md\:p-8 { padding: 2rem; }
      }
      @media (min-width: 640px) { /* sm: */
        .sm\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      }
      @media (min-width: 1024px) { /* lg: */
        .lg\:flex-row { flex-direction: row; }
        .lg\:gap-12 { gap: 3rem; }
        .lg\:w-1\/2 { width: 50%; }
      }
    </style>
</head>
  <body>
    <div id="root"></div>
    <!-- 
      React is inlined to prevent it from being blocked.
      The entire application logic is in the script block below.
    -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script type="module">
      const { React, ReactDOM } = window;
      const { useState, useEffect, useMemo } = React;

      // --- Constants ---
      const TANK_WIDTH = 188;
      const TANK_DEPTH = 72;
      const TANK_HEIGHT = 160;
      const MAX_CONTENT_PER_TANK = 1500;
      const WARN_LIMIT_LITERS = 350;

      // --- Tank Calculation Hook ---
      const useTankCalculation = (sensorDistance) => {
        return useMemo(() => {
          let fillHeight = TANK_HEIGHT - sensorDistance;
          if (fillHeight > TANK_HEIGHT) fillHeight = TANK_HEIGHT;
          if (fillHeight < 0) fillHeight = 0;

          const a = TANK_WIDTH / 2;
          const b = TANK_DEPTH / 2;
          const volumePerTank_cm3 = Math.PI * a * b * fillHeight;
          const totalLiters = (volumePerTank_cm3 * 2) / 1000;
          const litersPerTank = totalLiters / 2;
          let percentage = (litersPerTank / MAX_CONTENT_PER_TANK) * 100;
          if (percentage > 100) percentage = 100;
          if (percentage < 0) percentage = 0;
          
          const isWarning = totalLiters < WARN_LIMIT_LITERS;

          return {
            fillHeight: parseFloat(fillHeight.toFixed(1)),
            totalLiters: parseFloat(totalLiters.toFixed(1)),
            percentage: parseFloat(percentage.toFixed(1)),
            isWarning,
          };
        }, [sensorDistance]);
      };

      // --- ControlSlider Component ---
      const ControlSlider = ({ value, onChange, max }) => {
        return React.createElement('div', { className: 'flex flex-col items-center w-full px-2' },
          React.createElement('label', { htmlFor: 'sensor-distance', className: 'text-sm font-medium text-slate-300 mb-2' }, 'Sensor-Abstand von oben simulieren'),
          React.createElement('div', { className: 'flex items-center gap-4 w-full' },
            React.createElement('span', { className: 'text-xs text-slate-400' }, '0 cm'),
            React.createElement('input', { id: 'sensor-distance', type: 'range', min: '0', max: max, step: '0.5', value: value, onChange: (e) => onChange(Number(e.target.value)), className: 'slider' }),
            React.createElement('span', { className: 'text-xs text-slate-400' }, `${max} cm`)
          ),
          React.createElement('div', { className: 'mt-2 text-center' },
            React.createElement('span', { className: 'text-lg font-mono p-2 bg-slate-900 rounded-md text-amber-300' }, `${value.toFixed(1)} cm`)
          )
        );
      };

      // --- InfoPanel Component ---
      const InfoDisplay = ({ label, value, unit, className = '' }) => (
        React.createElement('div', { className: `info-display ${className}` },
          React.createElement('p', { className: 'text-sm text-slate-400' }, label),
          React.createElement('p', { className: 'text-2xl md:text-3xl font-bold text-white' },
            value, ' ', React.createElement('span', { className: 'text-lg text-slate-300' }, unit)
          )
        )
      );

      const InfoPanel = ({ totalLiters, percentage, fillHeight, isWarning }) => {
        return React.createElement('div', { className: 'space-y-4 w-full' },
          React.createElement('div', { className: 'grid grid-cols-1 sm:grid-cols-2 gap-4' },
            React.createElement(InfoDisplay, { label: 'Gesamtinhalt', value: totalLiters.toFixed(1), unit: 'Liter' }),
            React.createElement(InfoDisplay, { label: 'Füllstand', value: percentage.toFixed(1), unit: '%' })
          ),
          React.createElement(InfoDisplay, { label: 'Füllhöhe', value: fillHeight.toFixed(1), unit: 'cm' }),
          isWarning && React.createElement('div', { className: 'warning-box' },
            React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', style: { height: '1.5rem', width: '1.5rem' }, fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' },
              React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z' })
            ),
            React.createElement('p', { className: 'font-semibold' }, 'Warnung: Niedriger Füllstand!')
          )
        );
      };

      // --- Tank Component ---
      const Tank = ({ percentage, maxLiters }) => {
        const liquidTopPosition = 100 - percentage;
        const scalePoints = [];
        for (let literValue = 0; literValue <= maxLiters; literValue += 50) {
            scalePoints.push({ literValue, isMajor: literValue % 300 === 0 });
        }

        const wavePath = "M800 56.5C718.3 56.5 670.3 22.1 602.3 22.1C534.3 22.1 486.3 56.5 400 56.5C313.7 56.5 265.7 22.1 197.7 22.1C129.7 22.1 81.7 56.5 0 56.5V100H800V56.5Z";

        return React.createElement('div', { className: 'flex items-center gap-4' },
          React.createElement('div', { className: 'relative w-80 h-64 md:w-96 md:h-72 bg-slate-700/50 border-4 border-slate-600 rounded-full overflow-hidden shadow-inner' },
            React.createElement('div', { className: 'absolute left-0 w-full bg-amber-500 transition-all duration-700 ease-out', style: { top: `${liquidTopPosition}%`, bottom: 0 } },
              React.createElement('div', { className: 'absolute top-0 left-0 w-full h-4', style: { transform: 'translateY(-50%)' } },
                React.createElement('svg', { className: 'absolute h-full', style: { width: '200%' }, viewBox: '0 0 800 100', preserveAspectRatio: 'none' },
                  React.createElement('path', { d: wavePath, className: 'animate-wave', style: { fill: '#f59e0b', animationDuration: '10s' } }),
                  React.createElement('path', { d: wavePath, className: 'animate-wave', style: { fill: 'rgba(245, 158, 11, 0.5)', animationDuration: '12s', animationDirection: 'reverse' } })
                )
              )
            )
          ),
          React.createElement('div', { className: 'relative h-64 md:h-72', style: { width: '5rem' } },
            scalePoints.map(({ literValue, isMajor }) => {
              const bottomPosition = (literValue / maxLiters) * 100;
              if (bottomPosition > 100) return null;
              return React.createElement('div', { key: literValue, className: 'absolute left-0 w-full', style: { bottom: `${bottomPosition}%`, transform: 'translateY(50%)' } },
                React.createElement('div', { className: 'flex items-center justify-start gap-1', style: { color: '#94a3b8', fontSize: '0.75rem' } },
                  React.createElement('span', { style: { height: '1px', backgroundColor: isMajor ? '#64748b' : '#475569', width: isMajor ? '0.75rem' : '0.375rem', display: 'inline-block' } }),
                  React.createElement('div', { style: { width: '3rem', textAlign: 'left' } },
                    isMajor && React.createElement('span', { className: 'bg-slate-900/50 px-1 rounded-md whitespace-nowrap' }, `${literValue} L`)
                  )
                )
              );
            })
          )
        );
      };

      // --- App Component ---
      const App = () => {
        const [sensorDistance, setSensorDistance] = useState(80);
        const [isSensorMode, setIsSensorMode] = useState(false);

        useEffect(() => {
          const params = new URLSearchParams(window.location.search);
          const distanceParam = params.get('abstand');
          if (distanceParam !== null && !isNaN(Number(distanceParam))) {
            setSensorDistance(Number(distanceParam));
            setIsSensorMode(true);
          }
        }, []);

        const { fillHeight, totalLiters, percentage, isWarning } = useTankCalculation(sensorDistance);

        return React.createElement('div', { className: 'min-h-screen flex flex-col items-center justify-center p-4' },
          React.createElement('div', { className: 'main-card' },
            React.createElement('header', { className: 'p-6 border-b border-slate-700' },
              React.createElement('h1', { className: 'text-2xl md:text-3xl font-bold text-center text-amber-300 tracking-wider' }, 'Öltank Füllstandsanzeige')
            ),
            React.createElement('main', { className: 'p-6 md:p-8' },
              React.createElement('div', { className: 'flex flex-col lg:flex-row gap-8 lg:gap-12 items-center justify-center' },
                React.createElement('div', { className: 'w-full lg:w-1/2 flex justify-center items-center' },
                  React.createElement(Tank, { percentage: percentage, maxLiters: MAX_CONTENT_PER_TANK * 2 })
                ),
                React.createElement('div', { className: 'w-full lg:w-1/2' },
                  React.createElement(InfoPanel, { totalLiters: totalLiters, percentage: percentage, fillHeight: fillHeight, isWarning: isWarning })
                )
              ),
              !isSensorMode && React.createElement('div', { className: 'mt-8 pt-6 border-t border-slate-700' },
                React.createElement(ControlSlider, { value: sensorDistance, onChange: setSensorDistance, max: TANK_HEIGHT })
              )
            )
          ),
          !isSensorMode && React.createElement('footer', { className: 'text-center mt-6 text-slate-500 text-sm' },
            React.createElement('p', null, 'Simuliert den Füllstand von 2x Dehoust 1500L Öltanks.')
          )
        );
      };

      // --- Mount the App ---
      const rootElement = document.getElementById('root');
      const root = ReactDOM.createRoot(rootElement);
      root.render(React.createElement(React.StrictMode, null, React.createElement(App)));

    </script>
  </body>
</html>